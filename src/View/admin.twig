{% extends 'layout.twig' %}

{% block content %}

    <div class="container">
        <div class="row">
            <h3>Admin panel</h3>
        </div>
        <div class="row">
            <p>Informations du compte</p>
        </div>
            <div class="row"><p>Session ID : {{ session.session_id }}</p></div>
            <div class="row"><p>Pseudo : {{ session.pseudo }}</p></div>
            <div class="row"><p>Adresse mail : {{ session.email }}</p></div>
            <div class="row"><p>Date de création du compte : {{ session.date_register }}</p></div>
            <div class="row"><p>Rang : {{ session.rank }}</p></div>


        <div class="row">
            <a href="index.php?page=admin&method=listUser">Liste des utilisateurs</a>
        </div>
        <div class="row">
            <a href="index.php?page=admin&method=listArticle">Liste des articles</a>
        </div>
        <div class="row">
            <a href="index.php?page=admin&method=listComment">Liste des commentaires</a>
        </div>
        <div class="row">
            <a href="index.php?page=admin&method=changePassword">Changer de mot de passe</a>
        </div>

    </div>


    {% if password is defined %}
        {% if erreur is defined %}
            <button class="alert alert-danger">{{ erreur }}</button>
        {% endif %}
        {% if success is defined %}
            <button class="alert alert-success">{{ success }}</button>
        {% endif %}
        <div class="container">
            <div class="row">
                <p>Changement de mot de passe</p>
            </div>
            <div class="row">
                <form method="post" action="index.php?page=admin&method=changePassword">
                    <div class="form-group">
                        <label for="passwrd">Ancien mot de passe</label>
                        <input type="password" name="oldpassword" class="form-control" id="passwrd" placeholder="Ancien mot de passe">
                    </div>
                    <div class="form-group">
                        <label for="passwrd">Nouveau mot de passe</label>
                        <input type="password" name="password1" class="form-control" id="passwrd" placeholder="Nouveau mot de passe">
                    </div>
                    <div class="form-group">
                        <label for="passwrd">Re-rentrez le nouveau mot de passe</label>
                        <input type="password" name="password2" class="form-control" id="passwrd" placeholder="Vérification nouveau mot de passe">
                    </div>
                    <button type="submit" class="btn btn-primary">Changer</button>
                </form>
            </div>
        </div>
    {% endif %}

    {% if user is defined %}
        <hr>
        <div class="container">

                {% for users in user %}
                <div class="row">
                    <p>User ID : {{ users.id_user }}</p>
                </div>
                <div class="row">
                    <p>Pseudo : {{ users.pseudo }}</p>
                </div>
                <div class="row">
                    <p>Email : {{ users.email }}</p>
                </div>
                <div class="row">
                    <p>Date d'enregistrement : {{ users.date_register }}</p>
                </div>
                <div class="row">
                    <p>Rang :
                        {% if users.rank == 1%}
                        Administrateur
                        {% elseif users.rank == 2 %}
                        Utilisateur
                        {% endif %}
                    </p>
                </div>
                    <hr>
                {% endfor %}
        </div>
    {% endif %}


    {% if article is defined %}
        <hr>
        <div class="container">
            {% for articles in article %}
            <div class="row">
                <p>ID Article : {{ articles.id_article }}</p>
            </div>
            <div class="row">
                <p>Titre: {{ articles.title }}</p>
            </div>
            <div class="row">
                <p>Chapo : {{ articles.chapo }}</p>
            </div>
            <div class="row">
                <p>Contenu : {{ articles.content }}</p>
            </div>
            <div class="row">
            <p>Date de création: {{ articles.date }}</p>
            </div>
                {% if articles.date_update != null %}
            <div class="row">
                <p>Dernière modification le : {{ articles.date_update }}</p>
            </div>
                {% endif %}
            <div class="row">
                <p>Crée par : {{ articles.pseudo }}</p>
            </div>

            {% if articles.validated == '0' %}
                <a class="btn btn-primary" href="index.php?page=admin&method=approveArticle&idarticle={{ articles.id_article }}">Approuver</a>
            {% endif %}
                <a class="btn btn-primary" href="index.php?page=admin&method=editArticle&idarticle={{ articles.id_article }}">Editer</a>
                <a class="btn btn-danger" href="index.php?page=admin&method=deleteArticle&idarticle={{ articles.id_article }}">Supprimer</a>
            <hr>
            {% endfor %}

        </div>
    {% endif %}

    {% if comment is defined %}
        <hr>
        <div class="container">
            {% for comments in comment %}
                <div class="row">
                    <p>ID : {{ comments.id_comment }}</p>
                </div>
                <div class="row">

                    <p>Commentaire : {{ comments.content }}</p>
                </div>
                <div class="row">
                    <p>Ecrit par : {{ comments.pseudo }} le {{ comments.date }}</p>
                </div>
                <div class="row">
                    <p>Article : {{ comments.title }}</p>
                </div>
                {% if comments.validate == '1' %}
                <div class="row">
                    <p>Commentaire approuvé</p>
                </div>
                {% elseif comments.validate == '0' %}
                    <div class="row">
                        <p>Commentaire en attente de validation</p>
                    </div>
                    <a class="btn btn-primary" href="index.php?page=admin&method=approveComment&idcomment={{ comments.id_comment }}">Approuver</a>
                {% endif %}
                <a class="btn btn-danger" href="index.php?page=admin&method=deleteComment&idcomment={{ comments.id_comment }}">Supprimer</a>
                <hr>
            {% endfor %}
        </div>
    {% endif %}

{% endblock %}